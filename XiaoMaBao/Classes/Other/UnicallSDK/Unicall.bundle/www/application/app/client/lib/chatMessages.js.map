{"version":3,"sources":["meteor://💻app/client/lib/chatMessages.js"],"names":[],"mappings":"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","file":"/client/lib/chatMessages.js","sourcesContent":["(function() {\n\tvar __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\n\tthis.ChatMessages = (function() {\n\t\tfunction ChatMessages() {}\n\n\t\tChatMessages.prototype.init = function(node) {\n\t\t\tthis.editing = {};\n\t\t\tthis.wrapper = $(node).find(\".wrapper\");\n\t\t\tthis.input = $(node).find(\".input-message\").get(0);\n\t\t};\n\n\t\tChatMessages.prototype.resize = function() {\n\t\t\tvar dif;\n\t\t\tdif = 60 + $(\".messages-container\").find(\"footer\").outerHeight();\n\t\t\treturn $(\".messages-box\").css({\n\t\t\t\theight: \"calc(100% - \" + dif + \"px)\"\n\t\t\t});\n\t\t};\n\n\t\tChatMessages.prototype.toPrevMessage = function() {\n\t\t\tvar msgs;\n\t\t\tmsgs = this.wrapper.get(0).querySelectorAll(\".own:not(.system)\");\n\t\t\tif (msgs.length) {\n\t\t\t\tif (this.editing.element) {\n\t\t\t\t\tif (msgs[this.editing.index - 1]) {\n\t\t\t\t\t\treturn this.edit(msgs[this.editing.index - 1], this.editing.index - 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn this.edit(msgs[msgs.length - 1], msgs.length - 1);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tChatMessages.prototype.toNextMessage = function() {\n\t\t\tvar msgs;\n\t\t\tif (this.editing.element) {\n\t\t\t\tmsgs = this.wrapper.get(0).querySelectorAll(\".own:not(.system)\");\n\t\t\t\tif (msgs[this.editing.index + 1]) {\n\t\t\t\t\treturn this.edit(msgs[this.editing.index + 1], this.editing.index + 1);\n\t\t\t\t} else {\n\t\t\t\t\treturn this.clearEditing();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tChatMessages.prototype.getEditingIndex = function(element) {\n\t\t\tvar index, msg, msgs, _i, _len;\n\t\t\tmsgs = this.wrapper.get(0).querySelectorAll(\".own:not(.system)\");\n\t\t\tindex = 0;\n\t\t\tfor (_i = 0, _len = msgs.length; _i < _len; _i++) {\n\t\t\t\tmsg = msgs[_i];\n\t\t\t\tif (msg === element) {\n\t\t\t\t\treturn index;\n\t\t\t\t}\n\t\t\t\tindex++;\n\t\t\t}\n\t\t\treturn -1;\n\t\t};\n\n\t\tChatMessages.prototype.edit = function(element, index) {\n\t\t\tvar id, message;\n            var classList = element.getAttribute(\"class\");\n\t\t\tif (classList && (classList.startsWith(\"system \") || classList.endsWith(\" system\") || classList.indexOf(\" system \")>=0)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.clearEditing();\n\t\t\tid = element.getAttribute(\"id\");\n\t\t\tmessage = ChatMessage.findOne({\n\t\t\t\t_id: id,\n\t\t\t\t'u._id': Meteor.userId()\n\t\t\t});\n\t\t\tthis.input.value = message.msg;\n\t\t\tthis.editing.element = element;\n\t\t\tthis.editing.index = index || this.getEditingIndex(element);\n\t\t\tthis.editing.id = id;\n\t\t\telement.classList.add(\"editing\");\n\t\t\tthis.input.classList.add(\"editing\");\n\t\t\treturn setTimeout((function(_this) {\n\t\t\t\treturn function() {\n\t\t\t\t\treturn _this.input.focus();\n\t\t\t\t};\n\t\t\t})(this), 5);\n\t\t};\n\n\t\tChatMessages.prototype.clearEditing = function() {\n\t\t\tif (this.editing.element) {\n\t\t\t\tthis.editing.element.classList.remove(\"editing\");\n\t\t\t\tthis.input.classList.remove(\"editing\");\n\t\t\t\tthis.editing.id = null;\n\t\t\t\tthis.editing.element = null;\n\t\t\t\tthis.editing.index = null;\n\t\t\t\treturn this.input.value = this.editing.saved || \"\";\n\t\t\t} else {\n\t\t\t\treturn this.editing.saved = this.input.value;\n\t\t\t}\n\t\t};\n\n\t\tChatMessages.prototype.send = function(rid, input) {\n\t\t\tvar msg, sendMessage;\n\t\t\tif (s.trim(input.value) !== '') {\n\t\t\t\tif (this.isMessageTooLong(input)) {\n\t\t\t\t\treturn Errors[\"throw\"](t('Error_message_too_long'));\n\t\t\t\t}\n\t\t\t\tmsg = input.value;\n\t\t\t\tinput.value = '';\n\t\t\t\tif (!rid) {\n\t\t\t\t\trid = visitor.getRoom(true);\n\t\t\t\t}\n\t\t\t\tsendMessage = function(obj,callback) {\n\t\t\t\t\tvar command, match, msgObject, param;\n\t\t\t\t\tmsgObject = {\n\t\t\t\t\t\t_id: Random.id(),\n\t\t\t\t\t\trid: obj.rid,\n\t\t\t\t\t\tmsg: obj.msg,\n\t\t\t\t\t\ttoken: visitor.getToken(),\n\t\t\t\t\t\tclientType:Meteor.isCordova?device.platform:'webchat',\n\t\t\t\t\t\tfromWebSite: localStorage.getItem('_3partywebsite')\n\t\t\t\t\t};\n\t\t\t\t\tMsgTyping.stop(rid);\n\t\t\t\t\tif (msg[0] === '/') {\n\t\t\t\t\t\tmatch = msg.match(/^\\/([^\\s]+)(?:\\s+(.*))?$/m);\n\t\t\t\t\t\tif ((match != null)) {\n\t\t\t\t\t\t\tcommand = match[1];\n\t\t\t\t\t\t\tparam = match[2];\n\t\t\t\t\t\t\treturn Meteor.call('slashCommand', {\n\t\t\t\t\t\t\t\tcmd: command,\n\t\t\t\t\t\t\t\tparams: param,\n\t\t\t\t\t\t\t\tmsg: msgObject\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n            if(Meteor.isCordova){\n              msgObject.fromAppKey=Meteor.settings.public.unicallAppKey;\n            }\n\t\t\t\t\t\treturn Meteor.call('sendMessageLivechatData', msgObject, callback,function(err,result){\n              console.log(err)\n            });\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tif (!Meteor.userId()) {\n\t\t\t\t\treturn loginer.send({rid:rid,msg:msg},sendMessage)\n\t\t\t\t} else {\n\t\t\t\t\treturn sendMessage({rid:rid,msg:msg});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n    var loginer={\n      active:false,\n      msgs:[],\n      send:function(obj,callback){\n        var self = this;\n        if(this.active === false){\n          Meteor.call('registerGuest', visitor.getToken(),new Tools().getUrlParameterByName('tenant_id'), function(error, result) {\n            if (error != null) {\n              return showError('注册访客失败！');\n            }\n            return Meteor.loginWithPassword({id:result.user}, result.pass, function(error) {\n              if (error) {\n                return showError('访客登录失败！');\n              }\n              var userInfo = outerAgent.recoverUniqueUserInfo();\n              if(userInfo){\n                Meteor.call('update-visitor-name',userInfo.nickname,function(err,result){\n                  console.log(err);\n                })\n              }\n              self.msgs.forEach(function(o){\n                callback(o);\n              })\n            });\n          });\n          this.active = true;\n        }\n        this.msgs[this.msgs.length] = obj;\n      }\n    };\n\n\t\tChatMessages.prototype.deleteMsg = function(message) {\n\t\t\treturn Meteor.call('deleteMessage', message, function(error, result) {\n\t\t\t\tif (error) {\n\t\t\t\t\treturn Errors[\"throw\"](error.reason);\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tChatMessages.prototype.update = function(id, rid, input) {\n\t\t\tvar msg;\n\t\t\tif (s.trim(input.value) !== '') {\n\t\t\t\tmsg = input.value;\n\t\t\t\tMeteor.call('updateMessage', {\n\t\t\t\t\tid: id,\n\t\t\t\t\tmsg: msg\n\t\t\t\t});\n\t\t\t\tthis.clearEditing();\n\t\t\t\treturn MsgTyping.stop(rid);\n\t\t\t}\n\t\t};\n\n\t\tChatMessages.prototype.startTyping = function(rid, input) {\n\t\t\tif (s.trim(input.value) !== '') {\n\t\t\t\treturn MsgTyping.start(rid);\n\t\t\t} else {\n\t\t\t\treturn MsgTyping.stop(rid);\n\t\t\t}\n\t\t};\n\n\t\tChatMessages.prototype.bindEvents = function() {\n\t\t\tvar _ref;\n\t\t\tif ((_ref = this.wrapper) != null ? _ref.length : void 0) {\n\t\t\t\treturn $(\".input-message\").autogrow({\n\t\t\t\t\tpostGrowCallback: (function(_this) {\n\t\t\t\t\t\treturn function() {\n\t\t\t\t\t\t\treturn _this.resize();\n\t\t\t\t\t\t};\n\t\t\t\t\t})(this)\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\tChatMessages.prototype.tryCompletion = function(input) {\n\t\t\tvar re, user, value;\n\t\t\tvalue = input.value.match(/[^\\s]+$/);\n\t\t\tif ((value != null ? value.length : void 0) > 0) {\n\t\t\t\tvalue = value[0];\n\t\t\t\tre = new RegExp(value, 'i');\n\t\t\t\tuser = Meteor.users.findOne({\n\t\t\t\t\tusername: re\n\t\t\t\t});\n\t\t\t\tif (user != null) {\n\t\t\t\t\treturn input.value = input.value.replace(value, \"@\" + user.username + \" \");\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tChatMessages.prototype.keyup = function(rid, event) {\n\t\t\tvar i, input, k, keyCodes, _i, _j;\n\t\t\tinput = event.currentTarget;\n\t\t\tk = event.which;\n\t\t\tkeyCodes = [13, 20, 16, 9, 27, 17, 91, 19, 18, 93, 45, 34, 35, 144, 145];\n\t\t\tfor (i = _i = 35; _i <= 40; i = ++_i) {\n\t\t\t\tkeyCodes.push(i);\n\t\t\t}\n\t\t\tfor (i = _j = 112; _j <= 123; i = ++_j) {\n\t\t\t\tkeyCodes.push(i);\n\t\t\t}\n\t\t\tif (__indexOf.call(keyCodes, k) < 0) {\n\t\t\t\treturn this.startTyping(rid, input);\n\t\t\t}\n\t\t};\n\n\t\tChatMessages.prototype.keydown = function(rid, event) {\n\t\t\tvar input, k, _ref, _ref1;\n\t\t\tinput = event.currentTarget;\n\t\t\tk = event.which;\n\t\t\tthis.resize(input);\n\t\t\tif (k === 13 && !event.shiftKey) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tif (this.editing.id) {\n\t\t\t\t\tthis.update(this.editing.id, rid, input);\n\t\t\t\t} else {\n\t\t\t\t\tthis.send(rid, input);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (k === 9) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tthis.tryCompletion(input);\n\t\t\t}\n\t\t\tif (k === 27) {\n\t\t\t\tif (this.editing.id) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tthis.clearEditing();\n\t\t\t\t}\n\t\t\t} else if (k === 75 && (((typeof navigator !== \"undefined\" && navigator !== null ? (_ref = navigator.platform) != null ? _ref.indexOf('Mac') : void 0 : void 0) !== -1 && event.metaKey && event.shiftKey) || ((typeof navigator !== \"undefined\" && navigator !== null ? (_ref1 = navigator.platform) != null ? _ref1.indexOf('Mac') : void 0 : void 0) === -1 && event.ctrlKey && event.shiftKey))) {\n\t\t\t\treturn RoomHistoryManager.clear(rid);\n\t\t\t}\n\t\t};\n\n\t\tChatMessages.prototype.isMessageTooLong = function(input) {\n\t\t\treturn (input != null ? input.value.length : void 0) > this.messageMaxSize;\n\t\t};\n    ChatMessages.prototype.clickButton = function(rid, input) {\n      this.resize(input);\n      if (this.editing.id) {\n        this.update(this.editing.id, rid, input);\n      } else {\n        this.send(rid, input);\n      }\n    };\n\t\treturn ChatMessages;\n\n\t})();\n\n}).call(this);\n"]}