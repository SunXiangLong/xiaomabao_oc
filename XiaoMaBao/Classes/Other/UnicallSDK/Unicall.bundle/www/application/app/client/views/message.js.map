{"version":3,"sources":["meteor://💻app/client/views/message.js"],"names":[],"mappings":"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","file":"/client/views/message.js","sourcesContent":["// Generated by CoffeeScript 1.10.0\n(function() {\n  Template.message.helpers({\n    own: function() {\n      var ref;\n      if (((ref = this.u) != null ? ref._id : void 0) === Meteor.userId()) {\n        return 'own';\n      }\n    },\n    time: function() {\n      if(this.ts)\n        return moment(this.ts).format('HH:mm');\n      else\n        return moment(new Date()).format('HH:mm');\n    },\n    currentTime:function(){\n      if(this.ts)\n        return this.ts.getTime();\n      else\n        return new Date().getTime();\n    },\n    date: function() {\n      return moment(this.ts).format('LL');\n    },\n    avatarName:function(){\n\n    },\n    isTemp: function() {\n      if (this.temp === true) {\n        return 'temp';\n      }\n    },\n    messageOwner:function(){\n      var shownName = \"&nbsp;\";\n      var messageUserId = this.u._id;\n      var meteorUser = Meteor.user();\n      if(meteorUser && messageUserId){\n        if(messageUserId === meteorUser._id){\n          if(Meteor.isCordova){\n            return Meteor.settings.public.appUsername||shownName;\n          }else{\n            return shownName;\n          }\n\n        }\n      }\n      var realName = this.u.name.trim();\n      shownName = realName==='' ?shownName : realName.substring(0,8);\n      return shownName;\n    },\n    error: function() {\n      if (this.error) {\n        return 'msg-error';\n      }\n    },\n    payloadFile: function(){\n      return Session.get(\"redirect:\"+this._id)\n    },\n    redirectFile:function(){\n      return Session.get(\"redirectUrl:\"+this._id)\n    },\n    imagePayload:function(){\n      return Session.get(\"payloadType:\"+this._id) === 'image';\n    },\n    audioPayload:function(){\n      return Session.get(\"payloadType:\"+this._id) === 'audio';\n    },\n    imageLoadingUrl:function(){\n      return new Tools().getPath() + 'packages/rocketchat_livechat/public/image_loading.png';\n    },\n    audioPlayerUrl:function(){\n      return new Tools().getPath() + 'audio_player?'+Session.get(\"redirect:\"+this._id);\n    },\n    audioWidth:function(){\n      return 40+7*this.s3url.duration;\n    },\n    isIE:function(){\n      var isFirefox = navigator.userAgent.toUpperCase().indexOf(\"FIREFOX\")!== -1;\n      var isChrome = navigator.userAgent.toUpperCase().indexOf(\"CHROME\") !== -1;\n      return !(isFirefox||isChrome || Meteor.isCordova);\n    },\n    isCordova:function(){\n      return Meteor.isCordova;\n    },\n    body: function() {\n      var message;\n      switch (this.t) {\n        case 'r':\n          return t('Room_name_changed', {\n            room_name: this.msg,\n            user_by: this.u.username\n          });\n        case 'au':\n          return t('User_added_by', {\n            user_added: this.msg,\n            user_by: this.u.username\n          });\n        case 'ru':\n          return t('User_removed_by', {\n            user_removed: this.msg,\n            user_by: this.u.username\n          });\n        case 'ul':\n          return tr('User_left', {\n            context: this.u.gender\n          }, {\n            user_left: this.u.username\n          });\n        case 'uj':\n          return tr('User_joined_channel', {\n            context: this.u.gender\n          }, {\n            user: this.u.username\n          });\n        case 'wm':\n          return t('Welcome', {\n            user: this.u.username\n          });\n        default:\n          this.html = this.msg;\n          if (s.trim(this.html) !== '') {\n            this.html = s.escapeHTML(this.html);\n          }\n          message = this;\n          MarkDownRender(message);\n          message.html = emojione.toImage(message.html);\n          var spliter = message.html.indexOf('\\n');\n          if (spliter>=0) {\n            this.html = message.html.replace(/\\n/gm, '<br/>');\n            //if(this.urls){\n            //  for(url in this.urls){\n            //    this.html +=\"<img width='100%' src ='\"+this.urls[url].url+\"'></img>\";\n            //  }\n            //}\n          } else {\n            this.html = message.html;\n          }\n          if(message.imageBytes){\n            if(Meteor.isCordova){\n              return `<div><a href='${message.imageBytes}' class=\"swipebox\" title=\"预览\" ><img id=\"byte-image-${message._id}\" title='预览' class='image' src='${message.imageBytes}'/></a><div id=\"progress-image-${message._id}\" style=\"height: 2px;background-color: #00ff00;position: absolute;right: 0;\"></div></div>`\n            }else{\n              return `<div><img id=\"byte-image-${message._id}\" title='预览' class='local-image' src='${message.imageBytes}'/><div id=\"progress-image-${message._id}\" style=\"height: 2px;background-color: #00ff00;position: absolute;right: 0;\"></div></div>`\n            }\n          }else if(message.s3url) {\n            var item = message.s3url\n            if (item.contentType && item.contentType.match(/image\\/.*/)) {\n              Session.set(\"redirectUrl:\"+message._id,item.uri)\n              var imgId = Random.id()\n              //there is only one rurl in message\n              Session.set(\"payloadType:\"+message._id, 'image')\n              Session.set(\"redirect:\" + message._id, imgId)\n              Meteor.call('awsGetSignedUrl', item.uri, function (error, result) {\n                if (result !== null && result !== undefined){\n                  if(window['image-cache'] === null ||window['image-cache'] ===undefined){\n                    window['image-cache']=[];\n                  }\n                  //app增加图片放大功能\n                  if(Meteor.isCordova){\n                    $('#'+imgId).parent().prop('href',result);\n                  }\n                  window.document.getElementById(imgId).setAttribute('src', result);\n                  window.document.getElementById(imgId).setAttribute('originSrc', item.uri);\n                  for(var i = 0;i < window['image-cache'].length;i++){\n                    if(window['image-cache'][i] === item.uri){\n                      return;\n                    }\n                  }\n                  window['image-cache'][window['image-cache'].length] = item.uri;\n                }\n              })\n\n              return '';\n            }else{\n              var fileIcon = \"packages/rocketchat_livechat/public/unknownFile.png\";\n              if(item.contentType && item.contentType.match(/audio\\/.*/)){\n                var isFirefox = navigator.userAgent.toUpperCase().indexOf(\"FIREFOX\")!== -1;\n                var isChrome = navigator.userAgent.toUpperCase().indexOf(\"CHROME\") !== -1;\n                if (isChrome || isFirefox){\n                  Session.set(\"payloadType:\"+message._id, 'audio');\n                  Session.set(\"redirect:\" + message._id, item.uri);\n                  return '';\n                }else{\n                  //create a iframe to play audio\n                  Session.set(\"payloadType:\"+message._id, 'audio');\n                  Session.set(\"redirect:\" + message._id, item.uri);\n                  return '';\n                }\n              }else if(item.contentType && item.contentType.match(/video\\/.*|application\\/vnd.rn-realmedia/)){\n                fileIcon=\"packages/rocketchat_livechat/public/videoFile.png\";\n              }\n              else if(item.contentType && item.contentType.match(/application\\/pdf/)){\n                fileIcon=\"packages/rocketchat_livechat/public/pdfFile.png\";\n              }\n              else if(item.contentType && item.contentType.match(/application\\/vnd.ms-excel/)){\n                fileIcon=\"packages/rocketchat_livechat/public/excelFile.png\";\n              }\n              else if(item.contentType && item.contentType.match(/application\\/zip|application\\/x-zip-compressed/)){\n                fileIcon=\"packages/rocketchat_livechat/public/zipFile.png\";\n              }\n              else if(item.contentType && item.contentType.match(/application\\/msword|application\\/vnd.ms-project|application\\/vnd.openxmlformats-officedocument.wordprocessingml.document/)){\n                fileIcon=\"packages/rocketchat_livechat/public/wordFile.png\";\n              }\n\n              var maxLength = 246;\n              var shortName = item.filename;\n              if(shortName.indexOf('.') >=0){\n                var ps = shortName.split('.');\n                shortName='';\n                for(var i = 0;i<ps.length-1;i++){\n                  shortName+=ps[i]+'.';\n                }\n                shortName = shortName.substring(0,shortName.length -1);\n              }\n              if(shortName.length <= 10){\n                maxLength=(shortName.length+6)*12\n              }else{\n                shortName=shortName.substring(0,10)+'...';\n              }\n              var size =Math.round(item.contentLength/1024)===0?(item.contentLength+\"B\"):\n                Math.round(item.contentLength/(1024*1024))===0?(Math.round(item.contentLength/1024)+'k'):\n                  Math.round(item.contentLength/(1024*1024*1024))===0?(Math.round(item.contentLength/(1024*1024))+'m'):(Math.round(item.contentLength/(1024*1024*1024))+'g');\n              return '<div class=\"\" title=\"'+item.filename+'\" style=\"text-align:left;color:#777777;\"><img style=\"margin-bottom:-5px;margin-right:10px;\" src=\"'+new Tools().getPath()+fileIcon+'\"/><span onClick=\"window.open(\\''+item.uri+'\\')\">'+shortName+'</span><span style=\"font-size:10px;\">('+size+')</span></div>';\n\n            }\n          }\n          if(message.type === \"merchandise\") {\n            var innerHtml = '<div class=\"arrowBorder\"/><div class=\"arrow\"/>';\n            if(message.data.url && message.data.url !==''){\n              innerHtml +='<div class=\"msgBody\" title=\"'+message.data.url+'\" style=\"width:100%;\">';\n            }else{\n              innerHtml +='<div class=\"msgBody\" style=\"width:100%;\">';\n            }\n            if(message.data.title && message.data.title !==''){\n              innerHtml +='<div style=\"text-align:center;font-size: large;\">'+message.data.title+'</div>';\n            }\n            if(message.data.iconUrl && message.data.iconUrl !=='' && message.data.content && message.data.content !==''){\n              innerHtml +='<div><div style=\"width:30%;height:50%;display:inline-block;vertical-align: top;\"><img style=\"width:100%;\" src=\"'+message.data.iconUrl+'\"/></div><div style=\"width:65%;height:50%;display:inline-block;text-align:left;\">'+message.data.content+'</div></div>';\n            }else if(message.data.iconUrl && message.data.iconUrl !==''){\n              innerHtml +='<div><div style=\"width:100%;height:50%;display:inline-block;vertical-align: top;\"><img style=\"width:100%;\" src=\"'+message.data.iconUrl+'\"/></div></div>';\n            }else if(message.data.content && message.data.content !==''){\n              innerHtml +='<div><div style=\"width:100%;height:50%;display:inline-block;text-align:left;\">'+message.data.content+'</div></div>';\n            }\n            innerHtml +='</div>';\n            return innerHtml;\n          }\n          if(this.msg.length < 16){\n            return '<div class=\"arrowBorder\"/><div class=\"arrow\"/><div class=\"msgBody\" style=\"width:'+(this.msg.length+1)*12+'px;\">'+this.html+'</div>';\n          }else{\n            return '<div class=\"arrowBorder\"/><div class=\"arrow\"/><div class=\"msgBody\" style=\"width:'+246+'px;\">'+this.html+'</div>';\n          }\n\n      }\n    },\n    uriFromServer:function(){\n      return this.s3url.uri;\n    }\n    ,\n    system: function() {\n      var ref;\n      if ((ref = this.t) === 's' || ref === 'p' || ref === 'f' || ref === 'r' || ref === 'au' || ref === 'ru' || ref === 'ul' || ref === 'wm' || ref === 'uj') {\n        return 'system';\n      }\n    },\n    isUnread:function(){\n      if(this.u._id != Meteor.userId() && this.s3url.isRead === false){\n        return 'unRead';\n      }\n    }\n  });\n\n  Template.room.events({\n    \"click .image\":function(e){\n      var currentUri = e.currentTarget.getAttribute('originSrc');\n      var list=[];\n      var cache = window['image-cache'];\n      if(cache){\n        for(var i = 0;i <cache.length;i++){\n          list[list.length] = cache[i];\n        }\n      };\n      outerAgent.imagePreview({id:currentUri,list:list});\n    },\n    \"click .local-image\":function(e){\n      var src = e.currentTarget.getAttribute('src');\n      var id = e.currentTarget.getAttribute('id');\n      window[id] = src;\n      var list=[];\n      list[list.length] = id;\n      outerAgent.imagePreview({id:id,list:list});\n    },\n    \n    \"click .s3-swipebox\":function(event){\n      event.preventDefault();\n      $.swipebox([{ href:event.target.getAttribute('data-url')}]);\n    },\n    \"load .image\":function(e){\n      var currentUri = e.currentTarget.getAttribute('src');\n      //图片正在加载时，显示\"拼命加载中。。。\",此处是加载成功，立即显示图片\n    },\n    \"error .image\":function(e){\n      var currentUri = e.currentTarget.getAttribute('src');\n      //图片正在加载时，显示\"拼命加载中。。。\",此处是加载失败，显示失败图片，并且提供重新加载功能\n    },\n    \"click .audioMsg\":function(e){\n      Session.set('audioUrl',e.currentTarget.getAttribute('data-src'));\n      var player = $('#voice-player')[0];\n      var playing = $('.message .msgBody .playing');\n      Meteor.setTimeout(function(){\n        if(!player.paused){\n          //重新加载player,即停止.或者用pause\n          player.load();\n          playing.removeClass('playing');\n        }else{\n          playing.removeClass('playing');\n          //播放\n          player.play();\n          $(e.currentTarget).children('.audioIcon').addClass('playing');\n          if($(e.currentTarget).find('.unRead').length > 0){\n            $(e.currentTarget).find('.unRead').removeClass('unRead');\n            //setTimeout解决更新后立即停止BUG\n            Meteor.setTimeout(function(){\n              //设为已读\n              Meteor.call('readVoiceMsg',e.currentTarget.getAttribute('data-msgid'));\n            },e.currentTarget.getAttribute('data-duration')*1000);\n          }\n        }\n      },10);//延时10毫秒\n    }\n  })\n  Template.message.onViewRendered = function(context) {\n    var view;\n    view = this;\n    return this._domrange.onAttached(function(domRange) {\n      var fn, i, item, lastNode, len, newMessage, ref, ref1, ref2, ref3, ref4, ref5, ref6, ref7, ref8, ref9, ul, wrapper;\n      lastNode = domRange.lastNode();\n      if (((ref = lastNode.previousElementSibling) != null ? (ref1 = ref.getAttribute('data_date')) != null ? ref1 : void 0 : void 0) !== lastNode.getAttribute('data_date')) {\n\n        $(lastNode).addClass('new-day');\n        $(lastNode).removeClass('sequential');\n      } else if (((ref2 = lastNode.previousElementSibling) != null ? (ref3 = ref2.getAttribute('data_username')) != null ? ref3 : void 0 : void 0) !== lastNode.getAttribute('data_username')) {\n        $(lastNode).removeClass('sequential');\n      }\n      if (((ref4 = lastNode.nextElementSibling) != null ? (ref5 = ref4.getAttribute('data_date')) != null ? ref5 : void 0 : void 0) === lastNode.getAttribute('data_date')) {\n        $(lastNode.nextElementSibling).removeClass('new-day');\n        $(lastNode.nextElementSibling).addClass('sequential');\n      } else {\n        $(lastNode.nextElementSibling).addClass('new-day');\n        $(lastNode.nextElementSibling).removeClass('sequential');\n      }\n      if (((ref6 = lastNode.nextElementSibling) != null ? (ref7 = ref6.getAttribute('data_username')) != null ? ref7 : void 0 : void 0) !== lastNode.getAttribute('data_username')) {\n        $(lastNode.nextElementSibling).removeClass('sequential');\n      }\n      ul = lastNode.parentElement;\n      wrapper = ul.parentElement;\n      if (((ref8 = context.urls) != null ? ref8.length : void 0) > 0 && (Template.oembedBaseWidget != null)) {\n        ref9 = context.urls;\n        fn = function(item) {\n          var urlNode;\n          urlNode = lastNode.querySelector('.body a[href=\"' + item.url + '\"]');\n          if (urlNode != null) {\n            return $(urlNode).replaceWith(Blaze.toHTMLWithData(Template.oembedBaseWidget, item));\n          }\n        };\n        for (i = 0, len = ref9.length; i < len; i++) {\n          item = ref9[i];\n          fn(item);\n        }\n      }\n      if (lastNode.nextElementSibling == null) {\n        var classList = lastNode.getAttribute(\"class\");\n        if(classList && (classList.startsWith('own ') || classList.endsWith(' own') || classList.indexOf(' own ') >=0)){\n          return view.parentView.parentView.parentView.parentView.parentView.templateInstance().atBottom = true;\n        }\n        if (view.parentView.parentView.parentView.parentView.parentView.templateInstance().atBottom !== true) {\n            newMessage = document.querySelector(\".new-message\");\n            return newMessage.className = \"new-message\";\n          }\n      }\n    });\n  };\n}).call(this);\n"]}