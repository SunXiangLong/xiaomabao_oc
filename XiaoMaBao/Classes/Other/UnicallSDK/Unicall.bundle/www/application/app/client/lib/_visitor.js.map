{"version":3,"sources":["meteor://üíªapp/client/lib/_visitor.js"],"names":[],"mappings":";;;;;;;;;;AAEA,CAAC,YAAW;AACV,MAAI,CAAC,OAAO,GAAG,KAAK,CAAC,YAAW;AAC9B,QAAI,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,gBAAgB,CAAC;;AAExE,aAAS,MAAM,GAAG,EAAE;;AAEpB,SAAK,GAAG,IAAI,WAAW,CAAC,IAAI,CAAC,CAAC;;AAE9B,QAAI,GAAG,IAAI,WAAW,CAAC,IAAI,CAAC,CAAC;;;;;AAK7B,YAAQ,GAAG,YAAW;AACpB,UAAI,CAAC,YAAY,CAAC,OAAO,CAAC,cAAc,CAAC,EAAE;AACzC,oBAAY,CAAC,OAAO,CAAC,cAAc,EAAE,MAAM,CAAC,EAAE,EAAE,CAAC,CAAC;OACnD;AACD,aAAO,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,CAAC;KACxD,CAAC;;AAGF,YAAQ,GAAG,YAAW;AACpB,aAAO,KAAK,CAAC,GAAG,EAAE,CAAC;KACpB,CAAC;;AAEF,WAAO,GAAG,UAAS,GAAG,EAAE;AACtB,UAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AACd,aAAO,YAAY,CAAC,OAAO,CAAC,eAAe,EAAE,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;KAC1D,CAAC;;;;;;;AAOF,WAAO,GAAG,UAAS,aAAa,EAAE;AAChC,UAAI,MAAM,CAAC;AACX,UAAI,aAAa,IAAI,IAAI,EAAE;AACzB,qBAAa,GAAG,KAAK,CAAC;OACvB;AACD,YAAM,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;AACpB,UAAI,CAAC,MAAM,EAAE;AACX,cAAM,GAAG,YAAY,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC;AAC/C,YAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;OAClB;AACD,UAAK,CAAC,MAAM,IAAK,aAAa,EAAE;AAC9B,cAAM,GAAG,MAAM,CAAC,EAAE,EAAE,CAAC;AACrB,eAAO,CAAC,MAAM,CAAC,CAAC;OACjB;AACD,aAAO,MAAM,CAAC;KACf,CAAC;;AAEF,oBAAgB,GAAG,YAAU;AAC3B,UAAI,QAAQ,GAAG,MAAM,CAAC,QAAQ,UAAO,CAAC,wBAAwB,CAAC,QAAQ,IAAI,EAAE,CAAC;AAC9E,cAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC;AAC1B,YAAM,CAAC,IAAI,CAAC,gBAAgB,EAAC,QAAQ,EAAC,UAAS,KAAK,EAAC,MAAM,EAAC;AAC1D,YAAG,MAAM,EAAC;AACR,iBAAO,CAAC,GAAG,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;AAC7B,oBAAU,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,EAAE,EAAC,SAAS,EAAE,QAAQ,EAAC,CAAC,CAAC;SACrD,MAAK;AACJ,oBAAU,CAAC,EAAE,CAAC,QAAQ,EAAE,IAAI,EAAE,EAAC,SAAS,EAAE,QAAQ,EAAC,CAAC,CAAC;SACtD;OACF,CAAC,CAAC;KACJ;;AAED,UAAM,CAAC,SAAS,CAAC,QAAQ,GAAG,QAAQ,CAAC;;AAErC,UAAM,CAAC,SAAS,CAAC,QAAQ,GAAG,QAAQ,CAAC;;AAErC,UAAM,CAAC,SAAS,CAAC,OAAO,GAAG,OAAO,CAAC;;AAEnC,UAAM,CAAC,SAAS,CAAC,OAAO,GAAG,OAAO,CAAC;;AAEnC,UAAM,CAAC,SAAS,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;;AAErD,WAAO,MAAM,CAAC;GAEf,IAAG,EAAC,CAAC;CAEP,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,2D","file":"/client/lib/_visitor.js","sourcesContent":["// Generated by CoffeeScript 1.10.0\n//ÂÆö‰πâvisitor\n(function() {\n  this.visitor = new ((function() {\n    var getRoom, getToken, register, room, setRoom, token, ticketOrLivechat;\n\n    function _Class() {}\n\n    token = new ReactiveVar(null);\n\n    room = new ReactiveVar(null);\n\n    /**\n     *  Âú®ÊµèËßàÂô®‰∏≠ËÆ∞ÂΩïËÆøÂÆ¢‰ø°ÊÅØÔºåvisiorToken ÊòØ‰∏Ä‰∏™ Random\n     */\n    register = function() {\n      if (!localStorage.getItem('visitorToken')) {\n        localStorage.setItem('visitorToken', Random.id());\n      }\n      return token.set(localStorage.getItem('visitorToken'));\n    };\n\n\n    getToken = function() {\n      return token.get();\n    };\n\n    setRoom = function(rid) {\n      room.set(rid);\n      return localStorage.setItem('visitorRoomId', room.get());\n    };\n\n    /**\n     * Ëé∑Âèñ‰ºöËØùÊàøÈó¥ÔºåÂ¶ÇÊûú‰∏çÂ≠òÂú®ÂàôÊñ∞Âª∫ÊàøÈó¥\n     * @param createOnEmpty\n     * @returns {*}\n       */\n    getRoom = function(createOnEmpty) {\n      var roomId;\n      if (createOnEmpty == null) {\n        createOnEmpty = false;\n      }\n      roomId = room.get();\n      if (!roomId) {\n        roomId = localStorage.getItem('visitorRoomId');\n        room.set(roomId);\n      }\n      if ((!roomId) && createOnEmpty) {\n        roomId = Random.id();\n        setRoom(roomId);\n      }\n      return roomId;\n    };\n    //ÂéªlivechatËøòÊòØticket\n    ticketOrLivechat = function(){\n      var tenantId = Meteor.settings.public.tenant_livechat_settings.tenantId || '';\n      tenantId = btoa(tenantId);\n      Meteor.call('hasActiveAgent',tenantId,function(error,result){\n        if(result){\n          Session.set(\"whoEndMsg\", \"\");\n          FlowRouter.go('index', null, {tenant_id: tenantId});\n        }else {\n          FlowRouter.go('ticket', null, {tenant_id: tenantId});\n        }\n      });\n    }\n\n    _Class.prototype.register = register;\n\n    _Class.prototype.getToken = getToken;\n\n    _Class.prototype.setRoom = setRoom;\n\n    _Class.prototype.getRoom = getRoom;\n\n    _Class.prototype.ticketOrLivechat = ticketOrLivechat;\n\n    return _Class;\n\n  })());\n\n}).call(this);\n"]}